{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/luthf/Documents/INSTITUT%20TEKNOLOGI%20BANDUNG/SEMESTER%204/labubu%21/gukesh/src/frontend/magnus-v-gukesh/app/page.jsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect, useRef } from 'react';\nimport { Chessboard } from 'react-chessboard';\nimport axios from 'axios';\n\n// --- Helper Functions ---\nconst API_BASE_URL = 'http://127.0.0.1:8000'; // Your FastAPI backend URL\n\n// Converts algebraic notation from the backend to a format react-chessboard understands\nconst formatToUci = (from, to) => `${from}${to}`;\n\n// Converts row/col from react-chessboard to what the backend expects\nconst squareToCoords = (square) => {\n    const col = square.charCodeAt(0) - 'a'.charCodeAt(0);\n    const row = 8 - parseInt(square[1], 10);\n    return { row, col };\n};\n\n// --- Main Component ---\nexport default function Home() {\n    const [game, setGame] = useState(null); // Holds the entire game state from the backend\n    const [selectedAlgorithm, setSelectedAlgorithm] = useState('minimax');\n    const [aiDepth, setAiDepth] = useState(5);\n    const [analysisInfo, setAnalysisInfo] = useState(null);\n    const [error, setError] = useState('');\n    const [isLoading, setIsLoading] = useState(false);\n    const fileInputRef = useRef(null);\n\n    // This effect triggers the AI's move whenever it's White's turn\n    useEffect(() => {\n        if (game && game.turn === 'white' && !game.winner) {\n            handleAiMove();\n        }\n    }, [game]);\n\n    // --- API Handlers ---\n    const handleApiCall = async (apiCall) => {\n        setIsLoading(true);\n        setError('');\n        try {\n            const response = await apiCall();\n            if (response.data.error) {\n                setError(response.data.error);\n                setGame(null);\n            } else {\n                setGame(response.data);\n                if (response.data.ai_move) {\n                    setAnalysisInfo(response.data.ai_move);\n                }\n            }\n        } catch (err) {\n            setError('Failed to connect to the backend. Is the Python server running?');\n            console.error(err);\n        } finally {\n            setIsLoading(false);\n        }\n    };\n\n    const handleSetup = (setupType, payload) => {\n        let apiCall;\n        switch (setupType) {\n            case 'random':\n                apiCall = () => axios.get(`${API_BASE_URL}/api/setup_random`, { params: { algorithm: selectedAlgorithm, ai_depth: aiDepth } });\n                break;\n            case 'file':\n                const formData = new FormData();\n                formData.append('file', payload);\n                apiCall = () => axios.post(`${API_BASE_URL}/api/setup_from_file?algorithm=${selectedAlgorithm}&ai_depth=${aiDepth}`, formData, {\n                    headers: { 'Content-Type': 'multipart/form-data' },\n                });\n                break;\n        }\n        setAnalysisInfo(null);\n        handleApiCall(apiCall);\n    };\n    \n    const onPieceDrop = (sourceSquare, targetSquare) => {\n        if (isLoading || (game && game.turn !== 'black')) return false;\n\n        const start = squareToCoords(sourceSquare);\n        const end = squareToCoords(targetSquare);\n        \n        const apiCall = () => axios.post(`${API_BASE_URL}/api/player_move`, {\n            start_row: start.row,\n            start_col: start.col,\n            end_row: end.row,\n            end_col: end.col\n        });\n        handleApiCall(apiCall);\n        return true;\n    };\n\n    const handleAiMove = () => {\n        const apiCall = () => axios.get(`${API_BASE_URL}/api/ai_move`);\n        handleApiCall(apiCall);\n    };\n\n    const handlePlayback = (command) => {\n        const apiCall = () => axios.post(`${API_BASE_URL}/api/playback`, { command });\n        handleApiCall(apiCall);\n    };\n\n    const handleReset = () => {\n        setGame(null);\n        setAnalysisInfo(null);\n        setError('');\n    };\n\n    // --- Render ---\n    return (\n        <div className=\"min-h-screen bg-gray-900 text-white flex flex-col items-center justify-center p-4 font-sans\">\n            <div className=\"w-full max-w-5xl mx-auto flex flex-col lg:flex-row gap-8\">\n\n                {/* Left Side: Board and Playback */}\n                <div className=\"flex-grow lg:w-2/3\">\n                    <h1 className=\"text-4xl font-bold text-center mb-2\">AI Magnus vs Gukesh</h1>\n                    <p className=\"text-center text-gray-400 mb-4\">You play as Gukesh (Black King). It is {game ? `${game.turn}'s turn.` : 'not started.'}</p>\n                    <div className=\"relative w-full max-w-[600px] mx-auto aspect-square\">\n                        <Chessboard\n                            position={game ? game.board_fen : \"8/8/8/8/8/8/8/8 w - - 0 1\"}\n                            onPieceDrop={onPieceDrop}\n                            boardOrientation=\"black\"\n                            customBoardStyle={{ borderRadius: '8px', boxShadow: '0 5px 15px rgba(0, 0, 0, 0.5)' }}\n                            customDarkSquareStyle={{ backgroundColor: '#779556' }}\n                            customLightSquareStyle={{ backgroundColor: '#EBECD0' }}\n                        />\n                        {isLoading && (\n                            <div className=\"absolute inset-0 bg-black bg-opacity-60 flex items-center justify-center rounded-lg\">\n                                <div className=\"text-2xl font-bold animate-pulse\">AI is thinking...</div>\n                            </div>\n                        )}\n                    </div>\n                     {/* Playback Controls */}\n                    <div className=\"mt-4 p-4 bg-gray-800 rounded-lg shadow-lg flex justify-center items-center gap-2\">\n                        <h3 className=\"font-bold mr-4\">Playback:</h3>\n                        <button onClick={() => handlePlayback('first')} disabled={!game || game.current_move_index === 0} className=\"px-4 py-2 bg-gray-700 rounded hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed\">First</button>\n                        <button onClick={() => handlePlayback('undo')} disabled={!game || game.current_move_index === 0} className=\"px-4 py-2 bg-gray-700 rounded hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed\">Previous</button>\n                        <span className=\"w-24 text-center\">{game ? `Move ${game.current_move_index} / ${game.history_count - 1}` : 'N/A'}</span>\n                        <button onClick={() => handlePlayback('redo')} disabled={!game || game.current_move_index >= game.history_count - 1} className=\"px-4 py-2 bg-gray-700 rounded hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed\">Next</button>\n                        <button onClick={() => handlePlayback('last')} disabled={!game || game.current_move_index >= game.history_count - 1} className=\"px-4 py-2 bg-gray-700 rounded hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed\">Last</button>\n                    </div>\n                </div>\n\n                {/* Right Side: Controls and Analysis */}\n                <div className=\"lg:w-1/3 flex flex-col gap-6\">\n                    {/* Game Controls */}\n                    <div className=\"p-4 bg-gray-800 rounded-lg shadow-lg\">\n                        <h2 className=\"text-2xl font-bold border-b border-gray-700 pb-2 mb-4\">Game Controls</h2>\n                        <div className=\"space-y-3\">\n                            <div>\n                                <label htmlFor=\"algorithm\" className=\"block text-sm font-medium text-gray-300 mb-1\">Select Algorithm</label>\n                                <select id=\"algorithm\" value={selectedAlgorithm} onChange={(e) => setSelectedAlgorithm(e.target.value)} className=\"w-full p-2 bg-gray-700 rounded border border-gray-600 focus:ring-2 focus:ring-blue-500\">\n                                    <option value=\"minimax\">Minimax</option>\n                                    <option value=\"greedy\">Greedy</option>\n                                </select>\n                            </div>\n                             {selectedAlgorithm === 'minimax' && (\n                                <div>\n                                    <label htmlFor=\"depth\" className=\"block text-sm font-medium text-gray-300 mb-1\">AI Depth ({aiDepth})</label>\n                                    <input type=\"range\" id=\"depth\" min=\"2\" max=\"8\" step=\"1\" value={aiDepth} onChange={(e) => setAiDepth(parseInt(e.target.value))} className=\"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer\"/>\n                                </div>\n                            )}\n                            <div className=\"flex gap-2\">\n                                <button onClick={() => fileInputRef.current.click()} className=\"flex-1 px-4 py-2 bg-blue-600 rounded hover:bg-blue-500 font-semibold\">Upload Board</button>\n                                <input type=\"file\" ref={fileInputRef} onChange={(e) => handleSetup('file', e.target.files[0])} className=\"hidden\" accept=\".txt\"/>\n                                <button onClick={() => handleSetup('random')} className=\"flex-1 px-4 py-2 bg-green-600 rounded hover:bg-green-500 font-semibold\">Randomize</button>\n                            </div>\n                            <button onClick={handleReset} className=\"w-full px-4 py-2 bg-red-600 rounded hover:bg-red-500 font-semibold\">Reset</button>\n                        </div>\n                    </div>\n\n                    {/* Analysis Info */}\n                    <div className=\"p-4 bg-gray-800 rounded-lg shadow-lg flex-grow\">\n                        <h2 className=\"text-2xl font-bold border-b border-gray-700 pb-2 mb-4\">Analysis</h2>\n                        {game && game.winner ? (\n                            <div className=\"text-center text-3xl font-bold text-yellow-400\">\n                                {game.winner === 'draw' ? 'Draw!' : `${game.winner.charAt(0).toUpperCase() + game.winner.slice(1)} Wins!`}\n                            </div>\n                        ) : analysisInfo ? (\n                            <div className=\"space-y-2 text-sm\">\n                                <p><span className=\"font-bold text-gray-300\">AI Move:</span> {analysisInfo.from} to {analysisInfo.to}</p>\n                                {analysisInfo.mate_in && <p className=\"font-bold text-green-400 text-lg\">Mate in {analysisInfo.mate_in} moves!</p>}\n                                {analysisInfo.analysis && Object.entries(analysisInfo.analysis).map(([key, value]) => (\n                                     <p key={key}><span className=\"font-bold text-gray-300\">{key.replace(/_/g, ' ').replace(/\\b\\w/g, l => l.toUpperCase())}:</span> {typeof value === 'number' ? value.toFixed(2) : value}</p>\n                                ))}\n                            </div>\n                        ) : (\n                            <p className=\"text-gray-400\">No analysis yet. Make a move to begin.</p>\n                        )}\n                         {error && <p className=\"mt-4 text-red-400 bg-red-900 p-3 rounded\">{error}</p>}\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;;;AAJA;;;;AAMA,2BAA2B;AAC3B,MAAM,eAAe,yBAAyB,2BAA2B;AAEzE,wFAAwF;AACxF,MAAM,cAAc,CAAC,MAAM,KAAO,AAAC,GAAS,OAAP,MAAU,OAAH;AAE5C,qEAAqE;AACrE,MAAM,iBAAiB,CAAC;IACpB,MAAM,MAAM,OAAO,UAAU,CAAC,KAAK,IAAI,UAAU,CAAC;IAClD,MAAM,MAAM,IAAI,SAAS,MAAM,CAAC,EAAE,EAAE;IACpC,OAAO;QAAE;QAAK;IAAI;AACtB;AAGe,SAAS;;IACpB,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE,OAAO,+CAA+C;IACvF,MAAM,CAAC,mBAAmB,qBAAqB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAC3D,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACvC,MAAM,CAAC,cAAc,gBAAgB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACjD,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACnC,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAC3C,MAAM,eAAe,CAAA,GAAA,6JAAA,CAAA,SAAM,AAAD,EAAE;IAE5B,gEAAgE;IAChE,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;0BAAE;YACN,IAAI,QAAQ,KAAK,IAAI,KAAK,WAAW,CAAC,KAAK,MAAM,EAAE;gBAC/C;YACJ;QACJ;yBAAG;QAAC;KAAK;IAET,uBAAuB;IACvB,MAAM,gBAAgB,OAAO;QACzB,aAAa;QACb,SAAS;QACT,IAAI;YACA,MAAM,WAAW,MAAM;YACvB,IAAI,SAAS,IAAI,CAAC,KAAK,EAAE;gBACrB,SAAS,SAAS,IAAI,CAAC,KAAK;gBAC5B,QAAQ;YACZ,OAAO;gBACH,QAAQ,SAAS,IAAI;gBACrB,IAAI,SAAS,IAAI,CAAC,OAAO,EAAE;oBACvB,gBAAgB,SAAS,IAAI,CAAC,OAAO;gBACzC;YACJ;QACJ,EAAE,OAAO,KAAK;YACV,SAAS;YACT,QAAQ,KAAK,CAAC;QAClB,SAAU;YACN,aAAa;QACjB;IACJ;IAEA,MAAM,cAAc,CAAC,WAAW;QAC5B,IAAI;QACJ,OAAQ;YACJ,KAAK;gBACD,UAAU,IAAM,wIAAA,CAAA,UAAK,CAAC,GAAG,CAAC,AAAC,GAAe,OAAb,cAAa,sBAAoB;wBAAE,QAAQ;4BAAE,WAAW;4BAAmB,UAAU;wBAAQ;oBAAE;gBAC5H;YACJ,KAAK;gBACD,MAAM,WAAW,IAAI;gBACrB,SAAS,MAAM,CAAC,QAAQ;gBACxB,UAAU,IAAM,wIAAA,CAAA,UAAK,CAAC,IAAI,CAAC,AAAC,GAAgD,OAA9C,cAAa,mCAA+D,OAA9B,mBAAkB,cAAoB,OAAR,UAAW,UAAU;wBAC3H,SAAS;4BAAE,gBAAgB;wBAAsB;oBACrD;gBACA;QACR;QACA,gBAAgB;QAChB,cAAc;IAClB;IAEA,MAAM,cAAc,CAAC,cAAc;QAC/B,IAAI,aAAc,QAAQ,KAAK,IAAI,KAAK,SAAU,OAAO;QAEzD,MAAM,QAAQ,eAAe;QAC7B,MAAM,MAAM,eAAe;QAE3B,MAAM,UAAU,IAAM,wIAAA,CAAA,UAAK,CAAC,IAAI,CAAC,AAAC,GAAe,OAAb,cAAa,qBAAmB;gBAChE,WAAW,MAAM,GAAG;gBACpB,WAAW,MAAM,GAAG;gBACpB,SAAS,IAAI,GAAG;gBAChB,SAAS,IAAI,GAAG;YACpB;QACA,cAAc;QACd,OAAO;IACX;IAEA,MAAM,eAAe;QACjB,MAAM,UAAU,IAAM,wIAAA,CAAA,UAAK,CAAC,GAAG,CAAC,AAAC,GAAe,OAAb,cAAa;QAChD,cAAc;IAClB;IAEA,MAAM,iBAAiB,CAAC;QACpB,MAAM,UAAU,IAAM,wIAAA,CAAA,UAAK,CAAC,IAAI,CAAC,AAAC,GAAe,OAAb,cAAa,kBAAgB;gBAAE;YAAQ;QAC3E,cAAc;IAClB;IAEA,MAAM,cAAc;QAChB,QAAQ;QACR,gBAAgB;QAChB,SAAS;IACb;IAEA,iBAAiB;IACjB,qBACI,6LAAC;QAAI,WAAU;kBACX,cAAA,6LAAC;YAAI,WAAU;;8BAGX,6LAAC;oBAAI,WAAU;;sCACX,6LAAC;4BAAG,WAAU;sCAAsC;;;;;;sCACpD,6LAAC;4BAAE,WAAU;;gCAAiC;gCAAwC,OAAO,AAAC,GAAY,OAAV,KAAK,IAAI,EAAC,cAAY;;;;;;;sCACtH,6LAAC;4BAAI,WAAU;;8CACX,6LAAC,8JAAA,CAAA,aAAU;oCACP,UAAU,OAAO,KAAK,SAAS,GAAG;oCAClC,aAAa;oCACb,kBAAiB;oCACjB,kBAAkB;wCAAE,cAAc;wCAAO,WAAW;oCAAgC;oCACpF,uBAAuB;wCAAE,iBAAiB;oCAAU;oCACpD,wBAAwB;wCAAE,iBAAiB;oCAAU;;;;;;gCAExD,2BACG,6LAAC;oCAAI,WAAU;8CACX,cAAA,6LAAC;wCAAI,WAAU;kDAAmC;;;;;;;;;;;;;;;;;sCAK9D,6LAAC;4BAAI,WAAU;;8CACX,6LAAC;oCAAG,WAAU;8CAAiB;;;;;;8CAC/B,6LAAC;oCAAO,SAAS,IAAM,eAAe;oCAAU,UAAU,CAAC,QAAQ,KAAK,kBAAkB,KAAK;oCAAG,WAAU;8CAAkG;;;;;;8CAC9M,6LAAC;oCAAO,SAAS,IAAM,eAAe;oCAAS,UAAU,CAAC,QAAQ,KAAK,kBAAkB,KAAK;oCAAG,WAAU;8CAAkG;;;;;;8CAC7M,6LAAC;oCAAK,WAAU;8CAAoB,OAAO,AAAC,QAAoC,OAA7B,KAAK,kBAAkB,EAAC,OAA4B,OAAvB,KAAK,aAAa,GAAG,KAAM;;;;;;8CAC3G,6LAAC;oCAAO,SAAS,IAAM,eAAe;oCAAS,UAAU,CAAC,QAAQ,KAAK,kBAAkB,IAAI,KAAK,aAAa,GAAG;oCAAG,WAAU;8CAAkG;;;;;;8CACjO,6LAAC;oCAAO,SAAS,IAAM,eAAe;oCAAS,UAAU,CAAC,QAAQ,KAAK,kBAAkB,IAAI,KAAK,aAAa,GAAG;oCAAG,WAAU;8CAAkG;;;;;;;;;;;;;;;;;;8BAKzO,6LAAC;oBAAI,WAAU;;sCAEX,6LAAC;4BAAI,WAAU;;8CACX,6LAAC;oCAAG,WAAU;8CAAwD;;;;;;8CACtE,6LAAC;oCAAI,WAAU;;sDACX,6LAAC;;8DACG,6LAAC;oDAAM,SAAQ;oDAAY,WAAU;8DAA+C;;;;;;8DACpF,6LAAC;oDAAO,IAAG;oDAAY,OAAO;oDAAmB,UAAU,CAAC,IAAM,qBAAqB,EAAE,MAAM,CAAC,KAAK;oDAAG,WAAU;;sEAC9G,6LAAC;4DAAO,OAAM;sEAAU;;;;;;sEACxB,6LAAC;4DAAO,OAAM;sEAAS;;;;;;;;;;;;;;;;;;wCAG7B,sBAAsB,2BACpB,6LAAC;;8DACG,6LAAC;oDAAM,SAAQ;oDAAQ,WAAU;;wDAA+C;wDAAW;wDAAQ;;;;;;;8DACnG,6LAAC;oDAAM,MAAK;oDAAQ,IAAG;oDAAQ,KAAI;oDAAI,KAAI;oDAAI,MAAK;oDAAI,OAAO;oDAAS,UAAU,CAAC,IAAM,WAAW,SAAS,EAAE,MAAM,CAAC,KAAK;oDAAI,WAAU;;;;;;;;;;;;sDAGjJ,6LAAC;4CAAI,WAAU;;8DACX,6LAAC;oDAAO,SAAS,IAAM,aAAa,OAAO,CAAC,KAAK;oDAAI,WAAU;8DAAuE;;;;;;8DACtI,6LAAC;oDAAM,MAAK;oDAAO,KAAK;oDAAc,UAAU,CAAC,IAAM,YAAY,QAAQ,EAAE,MAAM,CAAC,KAAK,CAAC,EAAE;oDAAG,WAAU;oDAAS,QAAO;;;;;;8DACzH,6LAAC;oDAAO,SAAS,IAAM,YAAY;oDAAW,WAAU;8DAAyE;;;;;;;;;;;;sDAErI,6LAAC;4CAAO,SAAS;4CAAa,WAAU;sDAAqE;;;;;;;;;;;;;;;;;;sCAKrH,6LAAC;4BAAI,WAAU;;8CACX,6LAAC;oCAAG,WAAU;8CAAwD;;;;;;gCACrE,QAAQ,KAAK,MAAM,iBAChB,6LAAC;oCAAI,WAAU;8CACV,KAAK,MAAM,KAAK,SAAS,UAAU,AAAC,GAA6D,OAA3D,KAAK,MAAM,CAAC,MAAM,CAAC,GAAG,WAAW,KAAK,KAAK,MAAM,CAAC,KAAK,CAAC,IAAG;;;;;2CAEtG,6BACA,6LAAC;oCAAI,WAAU;;sDACX,6LAAC;;8DAAE,6LAAC;oDAAK,WAAU;8DAA0B;;;;;;gDAAe;gDAAE,aAAa,IAAI;gDAAC;gDAAK,aAAa,EAAE;;;;;;;wCACnG,aAAa,OAAO,kBAAI,6LAAC;4CAAE,WAAU;;gDAAmC;gDAAS,aAAa,OAAO;gDAAC;;;;;;;wCACtG,aAAa,QAAQ,IAAI,OAAO,OAAO,CAAC,aAAa,QAAQ,EAAE,GAAG,CAAC;gDAAC,CAAC,KAAK,MAAM;iEAC5E,6LAAC;;kEAAY,6LAAC;wDAAK,WAAU;;4DAA2B,IAAI,OAAO,CAAC,MAAM,KAAK,OAAO,CAAC,SAAS,CAAA,IAAK,EAAE,WAAW;4DAAI;;;;;;;oDAAQ;oDAAE,OAAO,UAAU,WAAW,MAAM,OAAO,CAAC,KAAK;;+CAAvK;;;;;;;;;;;yDAIjB,6LAAC;oCAAE,WAAU;8CAAgB;;;;;;gCAE/B,uBAAS,6LAAC;oCAAE,WAAU;8CAA4C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAM5F;GAhLwB;KAAA","debugId":null}}]
}